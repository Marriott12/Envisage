(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[240],{9379:function(e,t,a){Promise.resolve().then(a.bind(a,941))},941:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return MarketplacePage}});var r=a(7437),s=a(2265),l=a(4033),n=a(732),i=a(5925),o=a(4020),c=a(9828),d=a(6689),u=a(6691),m=a.n(u),g=a(1396),x=a.n(g),h=a(927),p=a(260),f=a(6263),v=a(2929),b=a(9367),y=a(1218),j=a(1628);function ListingCard(e){var t,a,l;let{listing:i,className:o,showFavorite:c=!0,onFavoriteToggle:d,isFavorite:u=!1}=e,[g,w]=s.useState(!1),[N,C]=s.useState(!0),k=i.images&&i.images.length>0?i.images[0]:"/images/placeholder.jpg";return(0,r.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:(0,j.cn)("group",o),children:(0,r.jsx)(x(),{href:"/marketplace/".concat(i.id),children:(0,r.jsxs)("div",{className:"card-hover overflow-hidden",children:[(0,r.jsxs)("div",{className:"relative aspect-[4/3] overflow-hidden",children:[g?(0,r.jsx)("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-gray-400 text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 mx-auto mb-2 bg-gray-300 rounded-lg flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})})}),(0,r.jsx)("p",{className:"text-sm",children:"No image available"})]})}):(0,r.jsx)(m(),{src:k,alt:i.title,fill:!0,className:(0,j.cn)("object-cover transition-all duration-300 group-hover:scale-105",N?"scale-110 blur-sm":"scale-100 blur-0"),onLoad:()=>C(!1),onError:()=>{w(!0),C(!1)},sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"}),N&&(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-200 animate-pulse"}),"active"!==i.status&&(0,r.jsx)("div",{className:"absolute top-2 left-2",children:(0,r.jsx)("span",{className:(0,j.cn)("badge","sold"===i.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:(0,j.Ez)(i.status)})}),(0,r.jsx)("div",{className:"absolute top-2 right-2",children:(0,r.jsx)("span",{className:(0,j.cn)("badge",(0,j.ox)(i.condition_type||"")),children:(0,j.Ez)((i.condition_type||"new").replace("_"," "))})}),c&&(0,r.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),d&&d(i.id,!u)},className:"absolute bottom-2 right-2 p-2 rounded-full bg-white/80 hover:bg-white transition-colors duration-200 shadow-md","aria-label":u?"Remove from favorites":"Add to favorites",children:u?(0,r.jsx)(y.Z,{className:"w-5 h-5 text-red-500"}):(0,r.jsx)(h.Z,{className:"w-5 h-5 text-gray-600 hover:text-red-500"})}),i.images&&i.images.length>1&&(0,r.jsxs)("div",{className:"absolute bottom-2 left-2 flex space-x-1",children:[i.images.slice(0,3).map((e,t)=>(0,r.jsx)("div",{className:(0,j.cn)("w-2 h-2 rounded-full",0===t?"bg-white":"bg-white/60")},t)),i.images.length>3&&(0,r.jsxs)("div",{className:"text-white text-xs bg-black/50 rounded px-1",children:["+",i.images.length-3]})]})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 mb-1 line-clamp-2 group-hover:text-primary-600 transition-colors",children:i.title}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-2xl font-bold text-primary-600",children:(0,j.T4)(i.price,i.currency)}),i.seller_rating&&(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(p.Z,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:i.seller_rating.toFixed(1)})]})]})]}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:i.description}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(f.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:i.location})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(v.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:(0,j.SY)(i.created_at)})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("div",{className:"w-4 h-4 bg-gray-300 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-xs text-white font-medium",children:(i.seller_name||(null===(t=i.seller)||void 0===t?void 0:t.name)||"S").charAt(0).toUpperCase()})}),(0,r.jsx)("span",{className:"truncate max-w-[100px]",children:i.seller_name||(null===(a=i.seller)||void 0===a?void 0:a.name)||"Seller"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(b.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:i.views||0})]})]})]}),(0,r.jsx)("div",{className:"mt-3",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:(0,j.Ez)("string"==typeof i.category?i.category:(null===(l=i.category)||void 0===l?void 0:l.name)||"Other")})})]})]})})})}var w=a(9843),N=a(3827);let C=[{value:"",label:"All Categories"},{value:"electronics",label:"Electronics"},{value:"clothing",label:"Clothing & Fashion"},{value:"home",label:"Home & Garden"},{value:"sports",label:"Sports & Recreation"},{value:"books",label:"Books & Media"},{value:"automotive",label:"Automotive"},{value:"other",label:"Other"}],k=[{value:"",label:"Any Condition"},{value:"new",label:"New"},{value:"like_new",label:"Like New"},{value:"good",label:"Good"},{value:"fair",label:"Fair"},{value:"poor",label:"Poor"}],L=[{value:"newest",label:"Newest First"},{value:"oldest",label:"Oldest First"},{value:"price_low",label:"Price: Low to High"},{value:"price_high",label:"Price: High to Low"},{value:"popular",label:"Most Popular"}];function MarketplacePage(){let e=(0,l.useSearchParams)(),[t,a]=(0,s.useState)([]),[u,m]=(0,s.useState)(!0),[g,x]=(0,s.useState)(null),[h,p]=(0,s.useState)(!1),[f,v]=(0,s.useState)(0),[b,y]=(0,s.useState)(1),[j,S]=(0,s.useState)((null==e?void 0:e.get("search"))||""),[_,F]=(0,s.useState)((null==e?void 0:e.get("category"))||""),[E,P]=(0,s.useState)((null==e?void 0:e.get("condition"))||""),[Z,M]=(0,s.useState)((null==e?void 0:e.get("min_price"))||""),[R,A]=(0,s.useState)((null==e?void 0:e.get("max_price"))||""),[D,z]=(0,s.useState)((null==e?void 0:e.get("location"))||""),[O,B]=(0,s.useState)((null==e?void 0:e.get("sort"))||"newest"),fetchListings=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{m(!0),x(null);let r={page:e,search:j,category:_,condition:E,min_price:Z?parseFloat(Z):void 0,max_price:R?parseFloat(R):void 0,location:D,sort:O,limit:12},s=Object.fromEntries(Object.entries(r).filter(e=>{let[t,a]=e;return void 0!==a&&""!==a})),l=await w.BG.getListings(s);if("success"===l.status){var t;a(l.data.listings||l.data),v((null===(t=l.data.pagination)||void 0===t?void 0:t.total)||l.data.listings.length)}else x(l.message||"Failed to load listings")}catch(e){console.error("Error fetching listings:",e),x(e.message||"Failed to load listings"),i.toast.error("Failed to load listings")}finally{m(!1)}};(0,s.useEffect)(()=>{fetchListings(1),y(1)},[j,_,E,Z,R,D,O]);let handleResetFilters=()=>{S(""),F(""),P(""),M(""),A(""),z(""),B("newest")},I=j||_||E||Z||R||D;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N.Z,{}),(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{className:"py-6",children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Marketplace"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[f," items available"]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[(0,r.jsx)("form",{onSubmit:e=>{e.preventDefault(),fetchListings(1)},className:"flex-1 lg:w-96",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",value:j,onChange:e=>S(e.target.value),placeholder:"Search listings...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),(0,r.jsx)(o.Z,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})}),(0,r.jsxs)("button",{onClick:()=>p(!h),className:"inline-flex items-center px-4 py-2 border rounded-lg font-medium transition-colors ".concat(h||I?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"),children:[(0,r.jsx)(c.Z,{className:"h-5 w-5 mr-2"}),"Filters",I&&(0,r.jsx)("span",{className:"ml-2 bg-primary-100 text-primary-800 text-xs font-medium px-2 py-0.5 rounded-full",children:"Active"})]})]})]})})})}),h&&(0,r.jsx)(n.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-white border-b shadow-sm",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,r.jsx)("select",{value:_,onChange:e=>F(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:C.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Condition"}),(0,r.jsx)("select",{value:E,onChange:e=>P(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:k.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price Range"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"number",placeholder:"Min",value:Z,onChange:e=>M(e.target.value),className:"flex-1 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),(0,r.jsx)("input",{type:"number",placeholder:"Max",value:R,onChange:e=>A(e.target.value),className:"flex-1 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),(0,r.jsx)("input",{type:"text",placeholder:"City or region",value:D,onChange:e=>z(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mt-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Sort by:"}),(0,r.jsx)("select",{value:O,onChange:e=>B(e.target.value),className:"p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:L.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]}),I&&(0,r.jsxs)("button",{onClick:handleResetFilters,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[(0,r.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Clear Filters"]})]})]})}),(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:u?(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[...Array(8)].map((e,t)=>(0,r.jsxs)("div",{className:"bg-white rounded-2xl p-4 shadow-sm animate-pulse",children:[(0,r.jsx)("div",{className:"aspect-square bg-gray-200 rounded-lg mb-4"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-2"}),(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded w-1/2"})]},t))}):g?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("p",{className:"text-red-600 mb-4",children:g}),(0,r.jsx)("button",{onClick:()=>fetchListings(b),className:"btn-primary",children:"Try Again"})]}):0===t.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"No listings found matching your criteria."}),I&&(0,r.jsx)("button",{onClick:handleResetFilters,className:"btn-primary",children:"Clear Filters"})]}):(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:t.map(e=>(0,r.jsx)(ListingCard,{listing:e},e.id))})})]})]})}},9843:function(e,t,a){"use strict";a.d(t,{BG:function(){return l}});var r=a(4829);let s=r.Z.create({baseURL:"http://localhost/Envisage/backend/public/api",timeout:1e4,headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{{let t=localStorage.getItem("auth_token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e.data,e=>{var t,a;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),window.location.href="/auth/login"),Promise.reject((null===(a=e.response)||void 0===a?void 0:a.data)||e)});let l={getListings:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;return Object.entries(e).forEach(e=>{let[a,r]=e;void 0!==r&&""!==r&&t.append(a,r.toString())}),s.get("/products?".concat(t.toString()))},getListing:async e=>s.get("/products/".concat(e)),createListing:async e=>s.post("/products",e),updateListing:async(e,t)=>s.put("/products/".concat(e),t),deleteListing:async e=>s.delete("/products/".concat(e)),getMyListings:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;return Object.entries(e).forEach(e=>{let[a,r]=e;void 0!==r&&""!==r&&t.append(a,r.toString())}),s.get("/seller/products?".concat(t.toString()))},searchListings:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.get("/products",{params:{search:e,...t}})},buyListing:async(e,t)=>{let a={...t,items:[{product_id:e,quantity:1}]};return s.post("/orders",a)}};t.ZP=s},1628:function(e,t,a){"use strict";a.d(t,{B3:function(){return getConditionLabel},Ez:function(){return capitalizeFirst},SY:function(){return formatRelativeTime},T4:function(){return formatPrice},cn:function(){return cn},ox:function(){return getConditionBadgeColor},p6:function(){return formatDate},xm:function(){return getConditionColor}});var r=a(7042),s=a(3986);function cn(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m)((0,r.W)(t))}function formatPrice(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:2}).format(e)}function formatDate(e){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric"}).format(new Date(e))}function formatRelativeTime(e){let t=new Date,a=new Date(e),r=Math.floor((t.getTime()-a.getTime())/1e3);if(r<60)return"Just now";let s=Math.floor(r/60);if(s<60)return"".concat(s," minute").concat(s>1?"s":""," ago");let l=Math.floor(s/60);if(l<24)return"".concat(l," hour").concat(l>1?"s":""," ago");let n=Math.floor(l/24);return n<30?"".concat(n," day").concat(n>1?"s":""," ago"):formatDate(e)}function capitalizeFirst(e){if(!e)return"";let t="string"==typeof e?e:e.name||e.slug||String(e);return t&&0!==t.length?t.charAt(0).toUpperCase()+t.slice(1):""}function getConditionBadgeColor(e){switch(e.toLowerCase()){case"new":return"badge-green";case"like_new":return"badge-blue";case"good":case"fair":return"badge-yellow";case"poor":return"badge-red";default:return"badge-gray"}}function getConditionColor(e){switch(e.toLowerCase()){case"new":return"bg-green-100 text-green-800";case"like_new":return"bg-blue-100 text-blue-800";case"good":return"bg-yellow-100 text-yellow-800";case"fair":return"bg-orange-100 text-orange-800";case"poor":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}function getConditionLabel(e){return({new:"New",like_new:"Like New",good:"Good",fair:"Fair",poor:"Poor"})[e.toLowerCase()]||capitalizeFirst(e)}},9367:function(e,t,a){"use strict";var r=a(2265);function EyeIcon({title:e,titleId:t,...a},s){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},a),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}let s=r.forwardRef(EyeIcon);t.Z=s},9828:function(e,t,a){"use strict";var r=a(2265);function FunnelIcon({title:e,titleId:t,...a},s){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},a),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}let s=r.forwardRef(FunnelIcon);t.Z=s}},function(e){e.O(0,[424,858,732,39,827,971,472,744],function(){return e(e.s=9379)}),_N_E=e.O()}]);