(()=>{var e={};e.id=7240,e.ids=[7240],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5158:e=>{"use strict";e.exports=require("http2")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},4817:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>d,routeModule:()=>u,tree:()=>o});var a=t(7096),r=t(6132),l=t(7284),i=t.n(l),n=t(2564),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let o=["",{children:["marketplace",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,4421)),"c:\\wamp64\\www\\Envisage\\frontend\\app\\marketplace\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,5345)),"c:\\wamp64\\www\\Envisage\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],d=["c:\\wamp64\\www\\Envisage\\frontend\\app\\marketplace\\page.tsx"],m="/marketplace/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/marketplace/page",pathname:"/marketplace",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},6375:(e,s,t)=>{Promise.resolve().then(t.bind(t,4259))},4259:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>MarketplacePage});var a=t(784),r=t(9885),l=t.n(r),i=t(7114),n=t(9139),c=t(345),o=t(6198),d=t(4586),m=t(7048),x=t(2451),u=t.n(x),g=t(1440),p=t.n(g),h=t(8e3),b=t(5657),v=t(1751),f=t(1790),j=t(1808),y=t(180),N=t(8699);function ListingCard({listing:e,className:s,showFavorite:t=!0,onFavoriteToggle:r,isFavorite:i=!1}){let[c,o]=l().useState(!1),[d,m]=l().useState(!0),x=e.images&&e.images.length>0?e.images[0]:"/images/placeholder.jpg";return(0,a.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:(0,N.cn)("group",s),children:(0,a.jsx)(p(),{href:`/marketplace/${e.id}`,children:(0,a.jsxs)("div",{className:"card-hover overflow-hidden",children:[(0,a.jsxs)("div",{className:"relative aspect-[4/3] overflow-hidden",children:[c?(0,a.jsx)("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-gray-400 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-2 bg-gray-300 rounded-lg flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})})}),(0,a.jsx)("p",{className:"text-sm",children:"No image available"})]})}):(0,a.jsx)(u(),{src:x,alt:e.title,fill:!0,className:(0,N.cn)("object-cover transition-all duration-300 group-hover:scale-105",d?"scale-110 blur-sm":"scale-100 blur-0"),onLoad:()=>m(!1),onError:()=>{o(!0),m(!1)},sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"}),d&&(0,a.jsx)("div",{className:"absolute inset-0 bg-gray-200 animate-pulse"}),"active"!==e.status&&(0,a.jsx)("div",{className:"absolute top-2 left-2",children:(0,a.jsx)("span",{className:(0,N.cn)("badge","sold"===e.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:(0,N.Ez)(e.status)})}),(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(0,a.jsx)("span",{className:(0,N.cn)("badge",(0,N.ox)(e.condition_type||"")),children:(0,N.Ez)((e.condition_type||"new").replace("_"," "))})}),t&&(0,a.jsx)("button",{onClick:s=>{s.preventDefault(),s.stopPropagation(),r&&r(e.id,!i)},className:"absolute bottom-2 right-2 p-2 rounded-full bg-white/80 hover:bg-white transition-colors duration-200 shadow-md","aria-label":i?"Remove from favorites":"Add to favorites",children:i?(0,a.jsx)(y.Z,{className:"w-5 h-5 text-red-500"}):(0,a.jsx)(h.Z,{className:"w-5 h-5 text-gray-600 hover:text-red-500"})}),e.images&&e.images.length>1&&(0,a.jsxs)("div",{className:"absolute bottom-2 left-2 flex space-x-1",children:[e.images.slice(0,3).map((e,s)=>(0,a.jsx)("div",{className:(0,N.cn)("w-2 h-2 rounded-full",0===s?"bg-white":"bg-white/60")},s)),e.images.length>3&&(0,a.jsxs)("div",{className:"text-white text-xs bg-black/50 rounded px-1",children:["+",e.images.length-3]})]})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-1 line-clamp-2 group-hover:text-primary-600 transition-colors",children:e.title}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-2xl font-bold text-primary-600",children:(0,N.T4)(e.price,e.currency)}),e.seller_rating&&(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(b.Z,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e.seller_rating.toFixed(1)})]})]})]}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(v.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:e.location})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(f.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:(0,N.SY)(e.created_at)})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("div",{className:"w-4 h-4 bg-gray-300 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-xs text-white font-medium",children:(e.seller_name||e.seller?.name||"S").charAt(0).toUpperCase()})}),(0,a.jsx)("span",{className:"truncate max-w-[100px]",children:e.seller_name||e.seller?.name||"Seller"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(j.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:e.views||0})]})]})]}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:(0,N.Ez)("string"==typeof e.category?e.category:e.category?.name||"Other")})})]})]})})})}var w=t(9576),_=t(8282);let k=[{value:"",label:"All Categories"},{value:"electronics",label:"Electronics"},{value:"clothing",label:"Clothing & Fashion"},{value:"home",label:"Home & Garden"},{value:"sports",label:"Sports & Recreation"},{value:"books",label:"Books & Media"},{value:"automotive",label:"Automotive"},{value:"other",label:"Other"}],C=[{value:"",label:"Any Condition"},{value:"new",label:"New"},{value:"like_new",label:"Like New"},{value:"good",label:"Good"},{value:"fair",label:"Fair"},{value:"poor",label:"Poor"}],q=[{value:"newest",label:"Newest First"},{value:"oldest",label:"Oldest First"},{value:"price_low",label:"Price: Low to High"},{value:"price_high",label:"Price: High to Low"},{value:"popular",label:"Most Popular"}];function MarketplacePage(){let e=(0,i.useSearchParams)(),[s,t]=(0,r.useState)([]),[l,x]=(0,r.useState)(!0),[u,g]=(0,r.useState)(null),[p,h]=(0,r.useState)(!1),[b,v]=(0,r.useState)(0),[f,j]=(0,r.useState)(1),[y,N]=(0,r.useState)(e?.get("search")||""),[P,S]=(0,r.useState)(e?.get("category")||""),[E,F]=(0,r.useState)(e?.get("condition")||""),[A,L]=(0,r.useState)(e?.get("min_price")||""),[M,Z]=(0,r.useState)(e?.get("max_price")||""),[R,z]=(0,r.useState)(e?.get("location")||""),[G,O]=(0,r.useState)(e?.get("sort")||"newest"),fetchListings=async(e=1)=>{try{x(!0),g(null);let s={page:e,search:y,category:P,condition:E,min_price:A?parseFloat(A):void 0,max_price:M?parseFloat(M):void 0,location:R,sort:G,limit:12},a=Object.fromEntries(Object.entries(s).filter(([e,s])=>void 0!==s&&""!==s)),r=await w.BG.getListings(a);"success"===r.status?(t(r.data.listings||r.data),v(r.data.pagination?.total||r.data.listings.length)):g(r.message||"Failed to load listings")}catch(e){console.error("Error fetching listings:",e),g(e.message||"Failed to load listings"),c.toast.error("Failed to load listings")}finally{x(!1)}};(0,r.useEffect)(()=>{fetchListings(1),j(1)},[y,P,E,A,M,R,G]);let handleResetFilters=()=>{N(""),S(""),F(""),L(""),Z(""),z(""),O("newest")},H=y||P||E||A||M||R;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_.Z,{}),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"py-6",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Marketplace"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[b," items available"]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),fetchListings(1)},className:"flex-1 lg:w-96",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",value:y,onChange:e=>N(e.target.value),placeholder:"Search listings...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),(0,a.jsx)(o.Z,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})}),(0,a.jsxs)("button",{onClick:()=>h(!p),className:`inline-flex items-center px-4 py-2 border rounded-lg font-medium transition-colors ${p||H?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"}`,children:[(0,a.jsx)(d.Z,{className:"h-5 w-5 mr-2"}),"Filters",H&&(0,a.jsx)("span",{className:"ml-2 bg-primary-100 text-primary-800 text-xs font-medium px-2 py-0.5 rounded-full",children:"Active"})]})]})]})})})}),p&&(0,a.jsx)(n.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-white border-b shadow-sm",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,a.jsx)("select",{value:P,onChange:e=>S(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:k.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Condition"}),(0,a.jsx)("select",{value:E,onChange:e=>F(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:C.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price Range"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"number",placeholder:"Min",value:A,onChange:e=>L(e.target.value),className:"flex-1 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),(0,a.jsx)("input",{type:"number",placeholder:"Max",value:M,onChange:e=>Z(e.target.value),className:"flex-1 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),(0,a.jsx)("input",{type:"text",placeholder:"City or region",value:R,onChange:e=>z(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mt-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Sort by:"}),(0,a.jsx)("select",{value:G,onChange:e=>O(e.target.value),className:"p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:q.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),H&&(0,a.jsxs)("button",{onClick:handleResetFilters,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"Clear Filters"]})]})]})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l?(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[...Array(8)].map((e,s)=>(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-4 shadow-sm animate-pulse",children:[(0,a.jsx)("div",{className:"aspect-square bg-gray-200 rounded-lg mb-4"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-2"}),(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded w-1/2"})]},s))}):u?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"text-red-600 mb-4",children:u}),(0,a.jsx)("button",{onClick:()=>fetchListings(f),className:"btn-primary",children:"Try Again"})]}):0===s.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"No listings found matching your criteria."}),H&&(0,a.jsx)("button",{onClick:handleResetFilters,className:"btn-primary",children:"Clear Filters"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:s.map(e=>(0,a.jsx)(ListingCard,{listing:e},e.id))})})]})]})}},4421:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>l,default:()=>c});var a=t(5153);let r=(0,a.createProxy)(String.raw`c:\wamp64\www\Envisage\frontend\app\marketplace\page.tsx`),{__esModule:l,$$typeof:i}=r,n=r.default,c=n}};var s=require("../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[2527,7721,7941,9139,1808,4262,5657,3687,4586,7089,3653,8282,9576,8699],()=>__webpack_exec__(4817));module.exports=t})();