"use strict";exports.id=4187,exports.ids=[4187],exports.modules={4187:(e,s,l)=>{l.r(s),l.d(s,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var i=l(784),a=l(9885),t=l(9576),n=l(3653);let __WEBPACK_DEFAULT_EXPORT__=()=>{let{user:e}=(0,n.a)(),[s,l]=(0,a.useState)([]),[d,r]=(0,a.useState)([]),[o,c]=(0,a.useState)(null),[m,h]=(0,a.useState)([]),[u,x]=(0,a.useState)(!1),[p,g]=(0,a.useState)(null);if(!e||!e.roles?.includes("admin"))return null;(0,a.useEffect)(()=>{let fetchRolesAndPermissions=async()=>{x(!0);try{let[e,s]=await Promise.all([t.ZP.get("/roles"),t.ZP.get("/permissions")]);l(e.data.roles||e.data),r(s.data.permissions||s.data)}catch(e){g("Failed to load roles or permissions")}finally{x(!1)}};fetchRolesAndPermissions()},[]);let handleRoleSelect=async e=>{c(e),x(!0);try{let s=await t.ZP.get(`/roles/${e.id}/permissions`);h(s.data.permission_ids||s.data)}catch{h([])}finally{x(!1)}},handlePermissionToggle=e=>{h(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},handleSave=async()=>{if(o){x(!0),g(null);try{await t.ZP.post(`/roles/${o.id}/permissions`,{permissions:m}),alert("Permissions updated!")}catch{g("Failed to update permissions")}finally{x(!1)}}};return(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow p-6 mt-8",children:[(0,i.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Role & Permission Management"}),p&&(0,i.jsx)("div",{className:"text-red-500 mb-2",children:p}),(0,i.jsxs)("div",{className:"flex gap-8",children:[(0,i.jsxs)("div",{className:"w-1/3",children:[(0,i.jsx)("h3",{className:"font-semibold mb-2",children:"Roles"}),(0,i.jsx)("ul",{children:s.map(e=>(0,i.jsx)("li",{className:`cursor-pointer p-2 rounded mb-1 ${o?.id===e.id?"bg-primary-100":""}`,onClick:()=>handleRoleSelect(e),children:e.name},e.id))})]}),(0,i.jsxs)("div",{className:"w-2/3",children:[(0,i.jsx)("h3",{className:"font-semibold mb-2",children:"Permissions"}),o?(0,i.jsxs)("div",{children:[(0,i.jsx)("ul",{className:"grid grid-cols-2 gap-2",children:d.map(e=>(0,i.jsx)("li",{children:(0,i.jsxs)("label",{className:"flex items-center gap-2",children:[(0,i.jsx)("input",{type:"checkbox",checked:m.includes(e.id),onChange:()=>handlePermissionToggle(e.id)}),e.name]})},e.id))}),(0,i.jsx)("button",{className:"btn-primary mt-4",onClick:handleSave,disabled:u,children:"Save Permissions"})]}):(0,i.jsx)("div",{className:"text-gray-500",children:"Select a role to manage permissions"})]})]})]})}}};